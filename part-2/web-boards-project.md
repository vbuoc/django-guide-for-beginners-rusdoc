# Проект Web Board 

> Оригинал: https://simpleisbetterthancomplex.com/series/2017/09/11/a-complete-beginners-guide-to-django-part-2.html

Не знаю, как вы, но я узнаю намного больше через практические примеры и сниппеты кода. Мне сложно понять принцип, когда в примерах написано `Class A`, `Class B` или классическое `foo(bar)`. И я бы не хотел делать это в этом руководстве.

Теперь, прежде чем мы приступим к веселой части, играя с моделями, представлениями и всем остальным, давайте поверхностно о проекте, который мы будем разрабатывать.

Если вы уже имеете опыт Web-разработки и считаете, что здесь все слишком подробно, просто гляньте на картинки, чтобы иметь представление о том, что мы будем делать и переходите к части [**Модели**](/part-2/models.md).

Если же вы новичок, я настоятельно рекомендую продолжить чтение. Это даст вам некоторые навыки моделирования и проектирования Web-приложений. Web-разработка, да и вообще разработка - не только про код.

![Rocket Science](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/Pixton_Comic_Rocket_Science.png)

## Диаграмма использования

Наш проект - нечто наподобие форума. Основная мысль в том, чтобы иметь несколько **"Досок"**, которые будут являться нашими категориями. А в каждой отдельной доске пользователь может начать новое обсуждение, создавая **"топик"**. В этом топике остальные пользователи могут вступить в обсуждение и оставлять ответы.

Нам нужен способ отличить обычного пользователя от администратора, поскольку администраторы могут создавать новые доски. Ниже представлены наши основные способы использования и роли каждого пользователя:

![Use Case Diagram](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/use-case-diagram.png)

*Рис. 1: Диаграмма использования базового функционала*

## Диаграмма классов

Из диаграммы использования мы можем начать размышлять о **"сущностях"** нашего проекта. Сущности - модели, которые мы будем создавать. И это очень близко к данным, которые наше Django-приложение будет обрабатывать.

Для того, чтомы мы могли реализовать варианты использования, приведенные на предыдущем рисунки, нам нужно реализовать следующие модели: **Board**, **Topic**, **Post** и **User**.

![Basic Class Diagram](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/basic-class-diagram.png)

*Рис. 2: Черновик диаграммы классов*

Так же важно подумать, как модели будут отновится друг к другу. Сплошные линии говорят нам, что **Topic** должен содержать поле, определяющее, к какому **Board** он относится. Также **Post** должен содержать поле для определения, к какому **Topic** он относится, чтобы мы могли отобразить только те посты, которые относятся к текущему обсужению. Так же нам нужны поля в **Topic** и **Post**, чтобы мы могли узнать, кто создал обсуждение и кто оставил сообщение.

Теперь, когда у нас есть базовое представление необходимых классов, мы можем подумать, какую информацию будет содержать каждая модель. Это может стать сложным очень быстро. Так что постарайтейсб сфокусироваться на главном - данных, которые нам нужны на старте. Остальное будет возможность добавить, используя **миграции**, о которых вы узнаете позже. 

А пока базовым представлением наших данных будут следующие поля:

![Class Diagram](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram.png)

*Рис. 3: Диаграмма классов, описывающая отношения этих классов*

Эта диаграмма классов включает отношения между моделями. Эти линии и стрелки потом будут переведены в поля.

Касаемо модели **Board**, мы начнем с двух полей: **name** и **description**. Поле **name** должно быть уникальным, чтобы избежать дублирования имен досок. **description** - только будет давать подсказку, о чем вообще эта доска.

Модель **Topic** будет состоять из четырех полей: **subject** - тема, **last update** - дата, которая будет определять порядок порядок топиков, **topic starter** - чтобы определить, какой пользователь создал топик, и поле **board**, чтобы определить, к какой доске относится топик.

Модель **Post** будет иметь поле **message**, которое будет использоваться для хранения текста постов ответов, поле **created at** с датой и временем, которое в основном будет использоваться для сортровки сообщений в топике, **updated at** с датой и временем, чтобы информировать пользователей о том, что пост был изменен, если это имело место быть. Так же, у нас должна быть ссылка на **User**: **created by** и **updated by**.

Наконец, модель **User**. В диаграмме классов я только упомянул поля **username**, **password**, **email** и флаг **is superuser**, поскольку это все, что мы будем использовать на данный момент. Так же важно помнить, что мы не должны создавать модель **User**, поскольку Django уже содержит в себе модель в пакете `contrib`. Мы будем использовать ее.

Что касается множественности в диаграмме классов (числа `1`, `0..*` и т.д.), вот как мы будем их читать:

![Class Diagram Board and Topic Association](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram-board-topic.png)

**Topic** должен быть связан только с одной(`1`) доской **Board**(что также означает, что оно не может быть `None`), а **Board** может быть связанна с многими **Topic** или ни с одним(`0..*`). Это означает, что **Board** может существовать без единого **Topic**.

![Class Diagram Topic and Post Association](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram-topic-post.png)

**Topic** должен иметь как минимум один **Post** (начальное сообщение), а так же там может быть множество сообщений (`1..*`). **Post** должен быть связан только с одним **Topic** (`1`).

![Class Diagram Topic and User Association](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram-topic-user.png)

**Topic** должен иметь связь только с одним **User**, который его создал(`1`). У **User** может быть много **Topic** или ни одного (`0..*`).

![Class Diagram Post and User Association](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram-post-user.png) 

A **Post** должен иметь один и только один **User**, связанный с: **created\_by** (`1`). A **User** может иметь много или ни одного **Post** (`0 .. *`). Вторая связь между **Post** и **User** является _прямой ассоциацией_ (см. Стрелку в конце строки), что означает, что нас интересует только одна сторона отношения, которая является тем, что **Пользователь** отредактировал данный **Post**. Он будет переведен в поле **updated by**. Множество `0..1`, значит, что поле **updated by** может быть пустым (**Post** не изменялся) или может быть связано только с одним **User**.

Другой способ нарисовать эту диаграмму классов - подчеркнуть поля, а не отношения между моделями:

![Class Diagram Attributes](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/class-diagram-attributes.png)

*Рис. 4: Диаграмма классов, подчеркивающая атрибуты(поля) классов(моделей)*

Данное представление эквивалентно предыдущему и оно очень близко тому, что мы собираемся сделать, используя модели Django. В этом
представлении мы можем четко увидеть, что поля модели **Post** (**topic**, **created by** и **updated by**) стали полями модели. Еще одна интересная вещь здесь - модель **Topic** имеет _действие_ (метод) **posts()**. Мы собираемся сделать это, реализовав обратную связь, где Django автоматически выполнит запрос к базе данных, чтобы вернуть список всех **Posts**, относящихся к конкретному **Topic**.

Все, достаточно UML. Для того, чтобы нарисовать диаграммы, представленные в этой секции, я использовал [StarUML](http://staruml.io).

##### Wireframes

Потратив некоторое время на проектирование моделей приложения, я бы хотел создать несколько каркасных макетов(Wireframe), чтобы определить, что должно быть сделано и чтобы иметь четкую картину того, что мы делаем.

![Wireframes Comic](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/Pixton_Comic_Wireframes.png)

Затем, основываясь на макетах, мы можем получить более глубокое понимание сущностей, используемых в приложении.

Первое, что нам потребуется - главная страница:


![Wireframe Boards](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/wireframe-boards.png)

*Рис. 5: Главная страница должна отображать все доступные доски.*

Если пользователь кликает на ссылку доски, должны быть отображены все топики:

![Wireframe Topics](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/wireframe-topics.png)

*Рис. 6: Список всех доступных топиков доски*

Здесь у нас два варианта: пользователь может кликнуть на "new topic", чтобы создать новый топик, или кликнуть на топик, чтобы увидеть или присоединиться к дискуссии.

Экран нового топика:

![Wireframe New Topic](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/wireframe-new-topic.png)

*Рис. 7: Экран нового топика*

Теперь экран топика, отображающий посты и обсуждение:

![Wireframe Posts](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/wireframe-posts.png)

*Рис. 8: Экран отображения списка постов*

Если пользователь нажмет на кнопку **reply**, он увидит экран, представленный ниже, с содержанием постов в обратном порядке (сначала новые):

![Wireframe Reply](https://simpleisbetterthancomplex.com/media/series/beginners-guide/1.11/part-2/wireframe-reply.png)

*Рис. 9: Экран ответа на топик*

Чтобы нарисовать эти макеты, вы можете использовать [draw.io](https://draw.io). Это бесплатно.
